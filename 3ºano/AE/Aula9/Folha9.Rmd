---
title: "Exercícios – Inferência Estatística"
author: ""
output: html_document
fontsize: 11pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
set.seed(123)
```


# Exercício 1 – Estimação pontual e propriedades 

Considere uma amostra aleatória simples $X_1, \dots, X_n$ de uma população com média $\mu$ e variância $\sigma^2$ (desconhecidas).

Além das questões teóricas, utilize o R para trabalhar com o conjunto de dados abaixo, que representa, por exemplo, o número de horas de sono por noite de $n=12$ estudantes durante um período de exames.

```{r}
dados_ex1 <- c(6.5, 7.0, 5.8, 8.2, 6.9, 7.5, 5.2, 6.1, 7.8, 6.3, 5.9, 7.1)
dados_ex1
length(dados_ex1)  # tamanho da amostra
```

1. **Estimadores usuais**

   (a) Indique os estimadores usuais para:

   * a média populacional $\mu$ (denote por $\hat\mu$ ou $\bar X$);
   * a variância populacional $\sigma^2$ (denote por $S^2$).

   (b) Escreva as expressões explícitas de $\bar X$ e $S^2$ em função de $X_1,\dots,X_n$.

   (c) Usando o R e os dados `dados_ex1`, calcule a média amostral e a variância amostral.
```{r}
n <- 12
mean(dados_ex1)
var(dados_ex1)
```

   Compare verbalmente os valores obtidos com a definição de $\bar X$ e $S^2$ dada nas alíneas anteriores.

2. **Não-enviesado e consistência**

   (a) Explique, em palavras, o que significa dizer que um estimador $\hat\theta$ é **não-enviesado** para um parâmetro $\theta$.
```{r}
"
Em palavras: **em média**, se repetíssemos a experiência muitas vezes, a média das estimativas coincidiria com o verdadeiro valor do parâmetro; o estimador não tende sistematicamente a sobrestimar nem a subestimar.
"
```
   (b) Explique, em palavras, o que significa **consistência** de um estimador.
```{r}
"com amostras cada vez maiores, a estimativa aproxima-se do valor verdadeiro."
```
   (c) Com base nas suas respostas, comente, de forma qualitativa, por que razão a média amostral $\bar X$ é um estimador “natural” para a média populacional $\mu$.

* $\bar X$ é a **média** dos valores observados – é o resumo mais simples da tendência central.
* Em muitas classes de modelos, sabe-se que $\bar X$ é **não-enviesado** para $\mu$ e **consistente**.
* Além disso, sob condições usuais, é um estimador “eficiente” (tem variância relativamente baixa face a outros estimadores razoáveis).

Por isso, é natural usar a média amostral como estimativa da média populacional.

   (d) Calcule, em R, o mínimo, máximo, média e desvio padrão dos valores em `dados_ex1`.

```{r}
min(dados_ex1)
max(dados_ex1)
mean(dados_ex1)
sd(dados_ex1)
```
---

# Exercício 2 – Intervalos de confiança para a média

Uma empresa está interessada na duração (em horas) de baterias produzidas numa certa linha de fabrico. Assume-se que a duração das baterias é aproximadamente normal.

Foi recolhida uma amostra de $n = 20$ baterias, com resultados (em horas) guardados num ficheiro `baterias.csv`, numa coluna denominada `duracao`.

1. **Importação e estatísticas descritivas**

   (a) Importe os dados para o R e calcule a média amostral $\bar x$ e o desvio-padrão amostral $s$.
```{r}
n_bat <- 20
y <- baterias$duracao
y
mean(y)
sd(y)
```

2. **IC para $\mu$ com $\sigma$ desconhecida**

   (b) Admitindo que a variância populacional é **desconhecida**, construa um **intervalo de confiança a 95%** para a média duração $\mu$, assumindo normalidade.

   * Indique a estatística utilizada.
   * Refira qual a distribuição (t de Student) envolvida.
   * Apresente a fórmula do intervalo de confiança.

   (c) Calcule esse intervalo de confiança explicitamente usando o R (pode usar `t.test`).
```{r}
t.test(y, conf.level = 0.95)$conf.int
```

3. **Interpretação**

   (d) Interprete o intervalo de confiança obtido em linguagem simples.

Se repetíssemos o processo de amostragem muitas vezes, cerca de (1−α)·100% dos intervalos conteriam o verdadeiro parâmetro.

   (e) Discuta o que aconteceria ao comprimento do intervalo se o tamanho amostral aumentasse (mantendo a mesma variabilidade). Justifique.
Mantendo a mesma variabilidade ($\sigma^2$ constante):

* O erro padrão $S/\sqrt{n}$ **diminui** quando $n$ aumenta.
* O comprimento do IC (proporcional a $t_{n-1;0.975} \cdot S/\sqrt{n}$) **encurta**.

Conclusão: com mais observações, o IC é **mais estreito**, refletindo **maior precisão** na estimativa de $\mu$.


Mesmo que a variabilidade seja a mesma, aumentar o tamanho da amostra reduz a amplitude do intervalo de confiança.
---

# Exercício 3 – Intervalo de confiança e teste de hipótese para uma proporção

Num inquérito a **200 estudantes**, perguntou-se se utilizam transportes públicos para se deslocar até à escola.
Dos 200 estudantes, **90** responderam “Sim”.

1. **Estimador e intervalo de confiança**

   (a) Calcule a proporção amostral $\hat p$ de estudantes que utilizam transportes públicos.
```{r}
n_est <- 200
sucessos <- 90
sucessos/n_est
```
   (b) Construa, usando uma aproximação normal, um **intervalo de confiança a 95%** para a proporção populacional $p$ de estudantes que usam transportes públicos.

   * Escreva a fórmula geral do IC para $p$.
   
   [p^−z1−α/2p^(1−p^)n−−−−−−−−√,;p^+z1−α/2p^(1−p^)n−−−−−−−−√]
   
   * Substitua os valores numéricos e apresente o intervalo.

   (c) Verifique o resultado usando a função `prop.test` no R (sem correcção de continuidade).

```{r}

prop.test(sucessos, n_est, conf.level = 0.95)$conf.int
```

2. **Teste de hipótese**

   (d) Suponha agora que se quer testar:

   $$
   H_0: p = 0.4 \quad \text{vs} \quad H_1: p \ne 0.4
   $$

   a nível de significância $\alpha = 0.05$.

   * Defina a estatística de teste aproximada (baseada na normal) e a sua distribuição sob $H_0$.
   * Calcule o valor observado da estatística de teste.
   * Calcule (ou obtenha no R) o $p$-valor.
```{r}
p_hat <- 90/200
p0    <- 0.4
n     <- 200

se0   <- sqrt(p0*(1-p0)/n)
Z     <- (p_hat - p0)/se0
Z

# p-valor bilateral
2 * (1 - pnorm(abs(Z)))

```
   (e) Indique a sua decisão relativamente a $H_0$ e interprete o resultado no contexto do problema (usando linguagem acessível).
   
> Os dados não fornecem evidência estatisticamente significativa, ao nível de 5%, para concluir que a proporção de estudantes que utilizam transportes públicos é diferente de 40%.
> A diferença observada (45% vs. 40%) pode ser explicada pela variabilidade amostral.

---

# Exercício 4 – Inferência na regressão linear simples

Pretende-se estudar a relação entre o número de horas de estudo por semana ($X$) e a nota obtida num teste de Estatística ($Y$), numa turma de 30 alunos. Os dados foram guardados num ficheiro `estudo_notas.csv`, com duas colunas: `horas_estudo` e `nota`.

1. **Ajuste do modelo**

   (a) Importe os dados para o R e faça um gráfico de dispersão de `nota` versus `horas_estudo`.
```{r}
library(ggplot2)
z <- estudo_notas
ggplot(z, aes(x = z$horas_estudo, y = z$nota)) +
  geom_point()
```

   (b) Ajuste um modelo de **regressão linear simples**:

   $$
   Y = \beta_0 + \beta_1 X + \varepsilon
   $$

   usando a função `lm` do R, e apresente o resumo dos resultados.
```{r}
modelo <- lm(nota ~ horas_estudo, data = z )
summary(modelo)
```

2. **Testes de hipótese sobre os coeficientes**

   (c) Considere o teste de hipótese:

   $$
   H_0: \beta_1 = 0 \quad \text{vs} \quad H_1: \beta_1 \ne 0.
   $$

   * Indique, em termos gerais, o que significa $H_0$ e o que significa $H_1$ neste contexto.
   * Usando a saída de `summary(mod)`, identifique o valor da estatística t para $\hat\beta_1$ e o respetivo $p$-valor.
* **$H_0$**: não há relação linear média entre horas de estudo e nota; aumentando as horas de estudo, a nota esperada não muda (no modelo).
* **$H_1$**: existe uma relação linear: as notas tendem a aumentar ou diminuir sistematicamente com as horas de estudo.

Na saída de `summary(modelo)`, a linha de `horas_estudo` mostra:

* `Estimate` = $\hat\beta_1$
* `Std. Error` = EP($\hat\beta_1$)
* `t value` = $\hat\beta_1 / \text{EP}(\hat\beta_1)$
* `Pr(>|t|)` = p-valor para o teste $H_0: \beta_1 = 0$.

   (d) A um nível de significância de 5%, qual é a sua conclusão relativamente a $H_0$?
   Interprete o resultado em linguagem simples.

3. **Intervalo de confiança para o declive**

   (e) Construa um **intervalo de confiança a 95%** para $\beta_1$ usando o R.
```{r}
confint(modelo, level = 0.95)

```

   (f) Interprete o intervalo obtido:

   * O que significa dizer que o IC para $\beta_1$ é, por exemplo, `[0.3; 0.8]`?
   * Como relaciona essa interpretação com o teste de hipótese realizado anteriormente?
   
Se, por exemplo, o IC a 95% para $\beta_1$ for `[0.3; 0.8]`:

* Significa que, com base nos dados, valores plausíveis para o **efeito médio de uma hora extra de estudo** na nota estão entre **0.3 e 0.8 pontos**.

  > Em média, aumentar uma hora de estudo por semana está associado a um aumento da nota entre 0.3 e 0.8 valores, aproximadamente.

* Como o intervalo **não contém 0**, isso é consistente com o teste de hipótese em que rejeitámos $H_0: \beta_1 = 0$ a 5%.
  Ou seja: o facto de 0 não pertencer ao IC a 95% equivale (neste contexto) a dizer que o teste bilateral a 5% rejeita $H_0$
---


```
::contentReference[oaicite:0]{index=0}
```
